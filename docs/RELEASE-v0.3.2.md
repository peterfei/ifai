# IfAI v0.3.2 发布说明

## 概览
**若爱 (IfAI) v0.3.2** 是一个专注于**性能与稳定性**的维护版本。本次更新彻底解决了 Windows 平台下的严重性能回归问题，并通过深度的架构优化，显著降低了编辑器的 CPU 占用率。

虽然这是一个补丁版本，但其底层的渲染逻辑重构为后续的大规模功能更新奠定了坚实的性能基础。

---

## 🚀 核心更新

### ⚡ Windows 性能深度优化
在之前的版本中，Windows 用户在快速输入代码时可能会遇到 CPU 占用率飙升至 99% 的问题。经过深入排查，我们发现这是由于 React 组件树的过度重渲染（Over-rendering）导致的。

v0.3.2 引入了以下机制彻底解决了此问题：
- **细粒度状态订阅**：重构了 `App`、`TabBar` 等核心组件，使其不再订阅整个文件存储（FileStore），而是仅订阅必要的元数据（如文件 ID）。
- **智能防抖策略**：在 `MonacoEditor` 中实现了平台感知的防抖机制。对于 Windows 平台，内容同步到全局状态的延迟被调整为 1秒，而 UI 的脏状态（Dirty State）更新保持实时，确保了"输入即响应"的流畅体验。
- **渲染隔离**：确保了文件内容的变更只会触发编辑器内部的更新，而不会波及到整个应用界面。

### 🎨 渲染引擎升级
- **浅层比较（Shallow Comparison）**：在 `TabBar` 等高频组件中引入了 Zustand 的 `shallow` 比较机制，避免了因对象引用变化导致的无效渲染。
- **输入延迟优化**：通过 E2E 测试验证，在高频输入场景下，应用根组件的重渲染次数从**线性增长（O(n)）降低为零（O(0)）**。

---

## 🧪 测试与验证

本次发布经过了严格的自动化测试验证：
- **性能回归测试**：新增了专门的 E2E 测试用例，模拟用户快速输入场景，并监控应用渲染计数器，确保重渲染问题得到根治。
- **跨平台验证**：测试通过了 macOS 和模拟的 Windows 行为场景。

---

## 📦 如何更新

### 自动更新
如果您已安装 IfAI，启动应用后将自动检测到新版本。点击更新提示即可完成升级。

### 手动下载
您可以前往 [GitHub Releases](https://github.com/peterfei/ifai/releases/tag/v0.3.2) 页面下载对应平台的安装包：
- **Windows**: `IfAI_0.3.2_x64_en-US.msi`
- **macOS (Apple Silicon)**: `IfAI_0.3.2_aarch64.dmg`
- **macOS (Intel)**: `IfAI_0.3.2_x64.dmg`

---

## 📝 变更日志

详细变更记录请参阅 [CHANGELOG.md](../CHANGELOG.md)。
