# 若爱 (IfAI) v0.2.7 - 体验跃迁：AI 代码回滚与工业级交互 🚀

**发布时间**: 2026-01-09

IfAI v0.2.7 是我们在 **交互体验** 与 **系统鲁棒性** 上的又一次飞跃。这个版本引入了备受期待的 **AI 代码回滚** 功能，赋予了开发者“后悔药”的能力；同时，通过 **智能 Diff 算法** 与 **流式渲染优化**，我们进一步提升了代码生成的透明度与系统性能。

我们不仅在打磨功能，更在重新定义 AI 时代下的编辑器交互标准。

---

## 🌟 核心亮点 (Highlights)

### ⏪ AI 代码回滚 (AI Rollback)
不再担心 AI 的误操作。现在你可以一键撤销 AI 生成的代码变更。
- **精准撤销**：支持撤销文件修改、新增及删除操作。
- **安全保障**：在执行大规模重构前拥有了坚实的底线保障。

### 🔍 智能 Diff 算法 (Smart Diff)
- **行级对比**：优化了 AI 修改代码时的展示逻辑，能够更精准地识别并标记行内细微变更。
- **清晰可见**：大幅降低了审阅 AI 代码时的认知负担。

### 🎨 工业级 UI 布局切换 (Layout Evolution)
- **极简而强大**：重构了 `LayoutSwitcher`，采用工业级设计语言，支持更丝滑的布局切换体验。
- **自定义布局**：支持开发者根据当前任务场景（如：专注编码、AI 对话、多屏调试）自由定制编辑器界面。

### 💬 智能消息差异化处理 (Smart Messaging)
- **多版本感知**：实现了连续消息发送的版本差异化处理，确保在长对话中 AI 能精准识别上下文的版本变更。

### 🐚 后台指令优化 (Command Optimization)
- **后台常驻修复**：修复了后台服务器持续运行导致的问题。
- **自动目录修正**：增强了 Bash 工具的工作目录自动修正逻辑，进一步提升 Agent 的环境自愈能力。

### 🧪 全链路自动化测试框架 (Automated Testing)
- **全自动验证**：引入了全链路 E2E 自动化测试框架，完成了核心业务逻辑的全面迁移与验证。
- **数据生成器**：引入了 mock 数据生成器，确保在复杂边界条件下系统的绝对稳定性。

---

## 📊 迭代数据统计 (v0.2.6 ~ v0.2.7)

在短短 2 天的密集迭代中，我们对核心编辑器体验进行了深度手术。

| 指标 | 统计数据 | 说明 |
| :--- | :--- | :--- |
| **文件变更数** | **100** 个文件 | 涵盖核心编辑器、AI 协议层及 UI 框架 |
| **代码新增行数** | **+11,535** 行 | 主要包含 E2E 测试用例及 Diff 引擎优化 |
| **代码删除/重构行数** | **-822** 行 | 进一步精简了流式渲染逻辑 |
| **提交次数 (Commits)** | **18** 次 | 高质量的特性演进与 Bug 修复 |

---

## 📝 详细变更日志 (Detailed Changes)

### 🚀 新增功能 (Features)
- **[Core]** 实现 AI 代码回滚功能，支持文件操作的全量撤销。
- **[UI]** 升级 LayoutSwitcher 为工业级 UI 设计，支持自定义布局。
- **[Diff]** 引入智能 Diff 算法，优化行级别变更显示。
- **[Test]** 完成 E2E 测试自动化迁移，新增数据生成器扩展。

### ⚡ 优化 (Improvements)
- **[Chat]** 优化流式渲染性能，合并相邻文本片段，显著减少 DOM 压力。
- **[Editor]** 修复语义导航与语法高亮，优化标签页切换体验。

### 🐛 修复 (Fixes)
- **[Agent]** 修复 Bash 工具结果未正确传递给 LLM 的关键 Bug。
- **[Bug]** 修复编辑器持久化失败、版本显示异常及线程隔离问题。
- **[ESM]** 修复某些依赖项的 ES 模块导入错误。

---

## 🤝 升级指南

1. 直接从 GitHub Release 页面下载最新版覆盖安装。
2. 建议升级后体验全新的布局切换器（快捷键或 UI 图标）。
