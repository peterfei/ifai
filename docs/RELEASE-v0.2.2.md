# IfAI Editor v0.2.2 发布说明

发布日期：2025-12-26

## 📋 版本概述

**v0.2.2** 是 IfAI 性能架构的里程碑。我们重构了底层的 I/O 引擎，将 Rust 的性能优势发挥到了极致。面对海量文件项目，IfAI 展现出了业界顶尖的响应速度。

---

## ⚡️ 核心聚焦：Rust 驱动的极致 I/O 引擎

为了达到“秒开百万文件”的性能目标，我们在目录扫描与文件系统交互上实施了 **4 层深度优化**：

### 1. 并行架构 (Parallel Architecture)
传统的编辑器多采用单线程递归扫描，遇到大目录即卡顿。IfAI v0.2.2 引入了基于 **Rayon** 的并行计算架构：
- **Work-Stealing 调度**：利用 Rayon 的工作窃取算法，动态平衡所有 CPU 核心的负载。当一个核心闲置时，会自动从其他忙碌核心的队列中“窃取”扫描任务，确保多核 CPU 始终 100% 满载运行。
- **DAG 任务图**：将目录树视为有向无环图（DAG），实现非阻塞的广度优先搜索（BFS），大幅提升了深层嵌套目录的扫描效率。

### 2. 智能过滤管线 (Smart Filtering Pipeline)
- **原生 .gitignore 支持**：集成 `ignore` crate，直接在文件系统底层解析 `.gitignore` 规则。无效文件（如 `node_modules`、`target`）在读取 metadata 之前即被丢弃，减少了 90% 的无效 I/O 系统调用。
- **流式处理 (Streaming)**：扫描结果通过 `crossbeam-channel` 实现无锁流式传输，UI 层无需等待扫描完成即可实时渲染首屏数据。

### 3. 零拷贝通信 (Zero-Copy Communication)
- **内存复用**：在 Rust 后端与 WebView 前端通信时，优化了序列化路径，避免了大量字符串的二次拷贝。
- **增量 Diff**：文件树状态更新采用增量 Diff 算法，仅传输变更节点，极大地降低了 IPC（进程间通信）带宽占用。

### 4. 实测数据 (Benchmark)
测试环境：MacBook Pro M3 Max, 1TB SSD
测试项目：大型 Monorepo (包含 150,000+ 文件)

| 指标 | v0.2.1 | **v0.2.2** | 提升幅度 |
| :--- | :--- | :--- | :--- |
| **全量扫描耗时** | 1.85s | **0.12s** | 🚀 **1500%** |
| **内存占用 (Peak)** | 240MB | **85MB** | 📉 **65%** |
| **UI 冻结时间** | ~300ms | **0ms** | ✨ **完美流畅** |

> 📖 **深度阅读**：关于我们如何实现这一性能突破的详细技术细节，请参阅 [IfAI 性能优化技术白皮书](./docs/tech/PERFORMANCE_OPTIMIZATION.md)。

---

## 🌟 其他核心更新

### 多会话并行管理 (Multi-Thread System)
- **标签页切换**：顶部新增会话标签页，支持一键创建新会话、切换现有会话。
- **并行执行**：每个会话拥有独立的上下文环境，互不干扰，支持多个 Agent 同时在后台运行。

### 强力数据持久化 (IndexedDB Persistence)
- **实时自动保存**：基于 IndexedDB，每一次对话和代码变更都实时落盘。
- **灾难恢复**：支持异常退出后的完美现场恢复。

### 探索 Agent 视觉升级
- **可视化进度**：全新的 `ExploreProgress` 组件，让后台的并行扫描过程可视化。

---

## 📊 变更统计

本次发布包含 **29** 个文件变更，新增代码 **5856** 行。

---

## 🔗 相关链接

- [GitHub 项目主页](https://github.com/peterfei/ifai)
- [多线程使用指南](./docs/THREADS_GUIDE.md)
- [问题反馈](https://github.com/peterfei/ifai/issues)
