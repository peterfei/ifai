# v0.2.0 任务分解清单

## 📋 任务追踪

使用此文档追踪 v0.2.0 的开发进度。完成后在对应任务前标记 ✅。

---

## Week 1: 文件管理增强

### Day 1-3: 文件树右键菜单

#### 前端任务
- [ ] 实现右键菜单组件 (`FileTreeContextMenu.tsx`)
  - [ ] 新建文件菜单项
  - [ ] 新建文件夹菜单项
  - [ ] 重命名菜单项
  - [ ] 删除菜单项
  - [ ] 复制路径菜单项
- [ ] 实现创建文件对话框 (`CreateFileDialog.tsx`)
- [ ] 实现重命名对话框 (`RenameDialog.tsx`)
- [ ] 实现删除确认对话框 (`DeleteConfirmDialog.tsx`)
- [ ] 更新 `FileTree.tsx` 集成右键菜单

#### 后端任务
- [ ] 添加 Tauri 命令：`create_file`
- [ ] 添加 Tauri 命令：`create_directory`
- [ ] 添加 Tauri 命令：`rename_file`
- [ ] 添加 Tauri 命令：`delete_file`
- [ ] 错误处理和验证

#### 测试
- [ ] 单元测试：文件操作命令
- [ ] 集成测试：UI 交互流程
- [ ] 边界测试：特殊文件名、权限问题

---

### Day 4-5: 拖拽支持

#### 前端任务
- [ ] 安装 `react-dnd` 或使用原生 Drag API
- [ ] 实现文件拖拽源 (`FileTreeItem.tsx`)
  - [ ] `onDragStart` 处理
  - [ ] 拖拽视觉反馈
- [ ] 实现文件拖拽目标 (`FileTree.tsx`)
  - [ ] `onDragOver` 处理
  - [ ] `onDrop` 处理
  - [ ] 拖拽高亮效果
- [ ] 实现外部文件拖入
- [ ] 实现拖拽到编辑器区域打开文件

#### 后端任务
- [ ] 添加 Tauri 命令：`move_file`
- [ ] 文件移动冲突处理

#### 测试
- [ ] 测试：文件夹内拖拽
- [ ] 测试：跨文件夹拖拽
- [ ] 测试：拖拽到编辑器打开
- [ ] 测试：外部文件拖入

---

### Day 6-7: 多标签页增强

#### 前端任务
- [ ] 实现标签页拖拽排序
  - [ ] 拖拽排序逻辑
  - [ ] 视觉反馈动画
- [ ] 实现标签页右键菜单
  - [ ] 关闭标签页
  - [ ] 关闭其他标签页
  - [ ] 关闭右侧标签页
  - [ ] 固定标签页
- [ ] 实现固定标签页功能
- [ ] 实现标签页分组（可选）

#### 状态管理
- [ ] 更新 `fileStore.ts` 添加固定状态
- [ ] 标签页排序状态管理

#### 测试
- [ ] 测试：拖拽排序
- [ ] 测试：右键菜单操作
- [ ] 测试：固定/取消固定

---

## Week 2: 编辑器功能增强

### Day 1-3: 代码片段管理器

#### 数据结构设计
- [ ] 定义片段数据结构
```typescript
interface CodeSnippet {
  id: string;
  name: string;
  prefix: string;
  body: string[];
  description: string;
  language: string;
  tags: string[];
  createdAt: number;
  updatedAt: number;
}
```

#### 前端任务
- [ ] 创建片段管理界面 (`SnippetManager.tsx`)
  - [ ] 片段列表
  - [ ] 片段搜索
  - [ ] 片段分类
- [ ] 创建片段编辑器 (`SnippetEditor.tsx`)
  - [ ] 表单输入
  - [ ] 预览功能
  - [ ] 变量插入
- [ ] 片段插入功能
  - [ ] 前缀触发
  - [ ] 命令面板选择
  - [ ] 快捷键插入

#### 后端任务
- [ ] 片段存储（JSON 文件）
- [ ] 添加 Tauri 命令：`load_snippets`
- [ ] 添加 Tauri 命令：`save_snippet`
- [ ] 添加 Tauri 命令：`delete_snippet`

#### Monaco 集成
- [ ] 注册片段提供者
- [ ] 占位符支持
- [ ] Tab 停靠点

#### 内置片段
- [ ] JavaScript/TypeScript 常用片段
- [ ] React 组件片段
- [ ] HTML/CSS 片段
- [ ] 导入内置片段库

#### 测试
- [ ] 测试：片段创建和编辑
- [ ] 测试：片段插入
- [ ] 测试：前缀触发
- [ ] 测试：占位符功能

---

### Day 4-5: 多光标和查找替换

#### 多光标增强
- [ ] 确认 Monaco 多光标快捷键
- [ ] 添加快捷键提示
- [ ] 创建多光标教程

#### 全局查找替换
- [ ] 创建查找替换面板 (`SearchPanel.tsx`)
  - [ ] 输入框（查找/替换）
  - [ ] 选项（正则、大小写、全词）
  - [ ] 结果列表
- [ ] 实现搜索逻辑
  - [ ] 当前文件搜索
  - [ ] 跨文件搜索
  - [ ] 文件类型过滤
- [ ] 实现替换逻辑
  - [ ] 单个替换
  - [ ] 全部替换
  - [ ] 替换预览

#### 后端任务
- [ ] 添加 Tauri 命令：`search_in_files`
- [ ] 添加 Tauri 命令：`replace_in_files`
- [ ] 使用 `ripgrep` 或 `grep` 库

#### 测试
- [ ] 测试：正则表达式搜索
- [ ] 测试：跨文件搜索
- [ ] 测试：批量替换

---

## Week 3: AI 功能优化

### Day 1-3: AI 上下文管理

#### 上下文选择优化
- [ ] 创建上下文管理器 UI (`ContextManager.tsx`)
  - [ ] 当前上下文显示
  - [ ] 添加/移除文件
  - [ ] 上下文大小计算
- [ ] 自动上下文分析
  - [ ] 相关文件推荐
  - [ ] import 分析
  - [ ] 依赖关系分析

#### 对话历史管理
- [ ] 对话持久化
- [ ] 按项目分组对话
- [ ] 对话搜索功能
- [ ] 对话导出/导入

#### 工具调用优化
- [ ] 批量审批 UI
- [ ] 工具调用历史查看
- [ ] 撤销机制（如果可能）

#### 后端任务
- [ ] 对话存储优化
- [ ] 上下文大小限制
- [ ] 智能裁剪算法

#### 测试
- [ ] 测试：上下文管理
- [ ] 测试：对话持久化
- [ ] 测试：工具批量审批

---

### Day 4-5: Prompt 模板系统

#### 模板设计
- [ ] 定义模板数据结构
```typescript
interface PromptTemplate {
  id: string;
  name: string;
  prompt: string;
  variables: string[];
  category: string;
  tags: string[];
}
```

#### 前端任务
- [ ] 模板管理界面 (`TemplateManager.tsx`)
  - [ ] 模板列表
  - [ ] 模板分类
  - [ ] 模板搜索
- [ ] 模板编辑器 (`TemplateEditor.tsx`)
  - [ ] 变量定义
  - [ ] 预览功能
- [ ] 模板使用
  - [ ] 快速选择
  - [ ] 变量填充对话框
  - [ ] 模板收藏

#### 内置模板
- [ ] 代码审查模板
- [ ] Bug 修复模板
- [ ] 功能实现模板
- [ ] 代码解释模板
- [ ] 性能优化模板
- [ ] 测试生成模板

#### 测试
- [ ] 测试：模板创建和使用
- [ ] 测试：变量替换
- [ ] 测试：模板分享

---

## Week 4: 性能优化和体验改进

### Day 1-2: 启动速度优化

#### 分析和测量
- [ ] 安装性能分析工具
- [ ] 记录当前启动时间基准
- [ ] 识别启动瓶颈

#### 优化措施
- [ ] 延迟加载非关键组件
  - [ ] 代码分割 (React.lazy)
  - [ ] 路由懒加载
- [ ] 优化 Rust 编译
  - [ ] 使用 LTO (Link Time Optimization)
  - [ ] 减少依赖编译
- [ ] 减少启动时的文件 I/O
  - [ ] 延迟加载配置
  - [ ] 缓存机制
- [ ] 使用 Web Worker
  - [ ] 异步加载大型库
  - [ ] 后台初始化

#### 测试
- [ ] 基准测试：启动时间
- [ ] 验证：目标 < 1.5s

---

### Day 3-4: 大文件和内存优化

#### 大文件处理
- [ ] 实现虚拟滚动
- [ ] 分块加载文件
- [ ] 限制语法高亮范围
- [ ] 只渲染可见区域
- [ ] 文件大小警告（>10MB）

#### 内存优化
- [ ] 分析内存使用
  - [ ] Chrome DevTools Profiler
  - [ ] 识别内存泄漏
- [ ] 优化措施
  - [ ] 及时释放关闭文件
  - [ ] 清理无用状态
  - [ ] 图片资源优化
  - [ ] 减少重复数据

#### 测试
- [ ] 基准测试：打开 10MB 文件
- [ ] 基准测试：内存占用
- [ ] 验证：内存减少 20%

---

### Day 5-7: 快捷键和 Markdown 预览

#### 快捷键系统
- [ ] 创建快捷键配置界面 (`KeybindingSettings.tsx`)
  - [ ] 快捷键列表
  - [ ] 搜索过滤
  - [ ] 冲突检测
- [ ] 快捷键编辑
  - [ ] 录制新快捷键
  - [ ] 重置默认
- [ ] 预设方案
  - [ ] VSCode 快捷键
  - [ ] Sublime 快捷键
  - [ ] Vim 快捷键（基础）
- [ ] 快捷键导入/导出

#### Markdown 预览
- [ ] 创建预览面板 (`MarkdownPreview.tsx`)
  - [ ] 分屏布局
  - [ ] 同步滚动
  - [ ] 实时更新
- [ ] Markdown 渲染
  - [ ] 使用 `react-markdown`
  - [ ] GFM 语法支持
  - [ ] 代码块高亮
- [ ] 增强功能
  - [ ] Mermaid 图表
  - [ ] LaTeX 数学公式
  - [ ] 目录生成
  - [ ] 导出 HTML/PDF

#### 测试
- [ ] 测试：快捷键配置
- [ ] 测试：Markdown 渲染
- [ ] 测试：同步滚动

---

## Week 5: 全面测试

### Day 1-3: 功能测试

#### 单元测试
- [ ] 文件操作测试
- [ ] 代码片段管理测试
- [ ] AI 功能测试
- [ ] 状态管理测试

**目标**: 覆盖率 > 60%

#### 集成测试
- [ ] 端到端测试框架设置（Playwright）
- [ ] 文件树交互测试
- [ ] 编辑器功能测试
- [ ] AI 对话流程测试
- [ ] 多标签页测试

---

### Day 4-5: 性能测试

#### 基准测试
- [ ] 启动时间测试
  - [ ] 冷启动
  - [ ] 热启动
  - [ ] 大项目启动
- [ ] 文件操作性能
  - [ ] 打开大文件
  - [ ] 保存文件
  - [ ] 搜索性能
- [ ] 内存占用测试
  - [ ] 空闲状态
  - [ ] 多文件打开
  - [ ] AI 对话后
- [ ] RAG 索引性能
  - [ ] 小项目 (<100 文件)
  - [ ] 中项目 (100-500 文件)
  - [ ] 大项目 (>500 文件)

#### 压力测试
- [ ] 长时间运行稳定性
- [ ] 内存泄漏检测
- [ ] 并发操作测试

---

### Day 6-7: Bug 修复

#### 高优先级 Bug
- [ ] RAG 索引大型项目崩溃
- [ ] AI 对话偶尔失去响应
- [ ] 深色主题文字不可读
- [ ] 多标签页切换卡顿

#### 中优先级 Bug
- [ ] LSP 连接不稳定
- [ ] 终端中文显示问题
- [ ] Git 状态未更新
- [ ] 设置需重启生效

#### 回归测试
- [ ] 运行所有测试套件
- [ ] 手动测试核心流程
- [ ] 性能基准验证

---

## Week 6: 文档和发布

### Day 1-2: 文档更新

#### 更新现有文档
- [ ] 更新 `README.md`
  - [ ] 新功能说明
  - [ ] 新截图
  - [ ] 快速开始更新
- [ ] 更新 `CHANGELOG.md`
  - [ ] 记录所有变更
  - [ ] 破坏性变更说明
  - [ ] 迁移指南
- [ ] 更新 `CONTRIBUTING.md`
  - [ ] 新的代码规范
  - [ ] 测试指南

#### 创建新文档
- [ ] 用户手册 (`USER_GUIDE.md`)
  - [ ] 功能详细说明
  - [ ] 使用技巧
  - [ ] 常见问题
- [ ] 开发文档 (`DEVELOPMENT.md`)
  - [ ] 架构说明
  - [ ] API 文档
  - [ ] 调试指南

---

### Day 3-4: Release Notes

- [ ] 编写 `RELEASE_NOTES_v0.2.0.md`
  - [ ] 版本亮点
  - [ ] 新功能详解
  - [ ] 性能改进数据
  - [ ] 已知问题
  - [ ] 升级指南
- [ ] 编写 `RELEASE_NOTES_v0.2.0_EN.md`
- [ ] 准备发布公告
  - [ ] 社区公告
  - [ ] 社交媒体文案

---

### Day 5: 发布准备

#### 版本检查
- [ ] 更新版本号
  - [ ] `package.json`: v0.2.0
  - [ ] `tauri.conf.json`: v0.2.0
  - [ ] `Cargo.toml`: v0.2.0
- [ ] 确认 LICENSE
- [ ] 确认依赖版本

#### 构建测试
- [ ] 构建前端: `npm run build`
- [ ] 构建 Tauri: `npm run tauri build`
- [ ] 测试安装包
  - [ ] Windows 安装包
  - [ ] macOS 安装包
  - [ ] Linux 安装包

#### 发布清单
- [ ] 所有测试通过
- [ ] 文档完整
- [ ] Release Notes 准备好
- [ ] 截图/视频准备好
- [ ] 安装包构建成功

---

### Day 6-7: 发布和推广

#### GitHub Release
- [ ] 创建 Git tag: v0.2.0
- [ ] 推送 tag 到 GitHub
- [ ] 创建 GitHub Release
  - [ ] 填写 Release Notes
  - [ ] 上传安装包
  - [ ] 标记为 latest

#### 社区推广
- [ ] 发布 GitHub Discussions 公告
- [ ] 更新项目主页
- [ ] 社交媒体分享
  - [ ] Twitter/X
  - [ ] 掘金
  - [ ] V2EX
  - [ ] Reddit (r/programming)
- [ ] 技术博客文章
  - [ ] 版本亮点介绍
  - [ ] 技术实现分享

#### 用户支持
- [ ] 监控 Issues
- [ ] 回复 Discussions
- [ ] 收集反馈
- [ ] 规划 v0.2.1 (bug 修复版本)

---

## 📊 进度追踪

### 总体进度

```
Week 1: [░░░░░░░░░░] 0%
Week 2: [░░░░░░░░░░] 0%
Week 3: [░░░░░░░░░░] 0%
Week 4: [░░░░░░░░░░] 0%
Week 5: [░░░░░░░░░░] 0%
Week 6: [░░░░░░░░░░] 0%
```

### 功能完成度

| 功能模块 | 进度 | 状态 |
|---------|------|------|
| 文件管理增强 | 0% | ⏳ 未开始 |
| 编辑器功能增强 | 0% | ⏳ 未开始 |
| AI 功能优化 | 0% | ⏳ 未开始 |
| 性能优化 | 0% | ⏳ 未开始 |
| 用户体验改进 | 0% | ⏳ 未开始 |
| 测试 | 0% | ⏳ 未开始 |
| 文档 | 0% | ⏳ 未开始 |

---

## 💡 开发提示

### 每日工作流

1. **晨会** (可选)
   - 回顾昨天进度
   - 计划今天任务
   - 识别阻塞问题

2. **开发**
   - 专注当前任务
   - 小步提交代码
   - 编写测试

3. **代码审查**
   - 自我审查
   - 运行测试
   - 性能检查

4. **日终总结**
   - 更新任务状态
   - 记录问题
   - 规划明天

### 质量保证

- ✅ 每个功能都有测试
- ✅ 代码风格一致
- ✅ 性能符合预期
- ✅ 无明显 Bug
- ✅ 文档同步更新

### 注意事项

- 🚨 遇到阻塞及时寻求帮助
- 🚨 性能问题优先解决
- 🚨 用户体验优先级高
- 🚨 保持代码简洁可维护

---

**文档生成时间**: 2025-12-17
**创建者**: peterfei
**使用方式**: 在开发过程中更新任务完成状态
