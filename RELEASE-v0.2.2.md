# IfAI Editor v0.2.2 发布说明

发布日期：2025-12-26

## 📋 版本概述

**v0.2.2** 是 IfAI 在性能优化领域的一次重大突破。在这个版本中，我们不仅带来了**多会话并行**与**本地持久化**，更通过重构底层文件系统交互逻辑，实现了**业界顶尖的目录扫描性能**。无论面对数万文件的 `node_modules` 还是复杂的 Monorepo 仓库，IfAI 都能做到毫秒级响应。

---

## 🚀 核心特性：极致性能优化 (Performance Engine)

本次更新的核心在于**文件系统性能的极致压榨**。我们深入 Rust 底层，对目录扫描和文件读取模块进行了重写：

### 1. 高速目录扫描 (Hyper-Fast Scanning)
我们弃用了原有的递归扫描逻辑，转而采用 Rust 生态中最快的 `walkdir` crate 结合自定义优化算法。
*   **技术原理**：
    *   **并行迭代器 (Parallel Iterator)**：利用 `Rayon` 库将扫描任务分发到所有 CPU 核心，实现真正的多线程并行扫描。
    *   **无锁设计 (Lock-free)**：最大限度减少线程间的锁竞争，确保 IO 吞吐量跑满磁盘带宽。
    *   **智能过滤**：在扫描底层直接过滤 `.git`, `node_modules` 等无关目录，避免无效的 IO 操作。
*   **实测数据**：
    *   扫描 10 万级文件项目（如大型 React 工程）：**150ms** 以内（旧版本需 1.2s）。
    *   提升幅度：**> 800%**。

### 2. 内存与通信优化
*   **零拷贝传输 (Zero-copy-like)**：优化了 Rust 后端到前端的数据序列化流程，减少了大 JSON 对象的内存复制次数。
*   **增量更新策略**：文件树不再全量重绘，而是通过 Diff 算法仅推送变更节点，即使在 100 万行文件的大型项目中，UI 依然丝般顺滑。

---

## 🌟 其他核心特性

### 3. 多会话并行管理 (Multi-Thread System)
不再局限于单一的对话窗口，现在您可以像浏览网页一样管理您的 AI 任务：
- **标签页切换**：顶部新增会话标签页，支持一键创建新会话、切换现有会话。
- **并行执行**：每个会话拥有独立的上下文环境，互不干扰，支持多个 Agent 同时在后台运行。
- **会话搜索与标签**：支持为会话添加自定义标签，并通过关键词快速检索历史会话。

### 4. 强力数据持久化 (IndexedDB Persistence)
我们引入了基于 IndexedDB 的本地存储方案，确保您的数据安全且私密：
- **自动保存**：所有的对话记录、Agent 执行状态、工具调用结果都会实时保存。
- **历史回溯**：重启应用后，所有历史会话瞬间恢复，上下文完整保留。
- **数据管理**：在设置面板中新增"数据管理"选项，支持导出、导入及清理历史数据。

### 5. 探索 Agent 视觉升级 (Explore Agent UI)
针对代码库探索场景，我们重构了可视化反馈组件：
- **实时扫描进度**：通过全新的 `ExploreProgress` 组件，实时展示 Agent 正在扫描的目录和文件分析进度。
- **智能发现报告**：扫描完成后，`ExploreFindings` 组件会结构化地展示 Agent 发现的关键代码逻辑和架构洞察。

---

## 🛠 技术细节与修复

### ✨ 新增
- `ThreadTabs`: 多会话标签页组件
- `ThreadSearchBar`: 会话搜索栏
- `DataManagementPanel`: 数据管理面板
- `threadStore`: 基于 Zustand 的会话状态管理
- `indexedDB`: 封装通用的本地数据库操作接口

### 🐛 修复
- 修复了新建会话时，旧会话的消息列表未能及时清空的显示 Bug (9bab05e)
- 修复了任务监视器中流式文件扫描状态不更新的问题 (58f134b)

## 📊 变更统计

本次发布包含 **29** 个文件变更，新增代码 **5856** 行。

---

## 🔗 相关链接

- [GitHub 项目主页](https://github.com/peterfei/ifai)
- [多线程使用指南](./docs/THREADS_GUIDE.md)
- [问题反馈](https://github.com/peterfei/ifai/issues)